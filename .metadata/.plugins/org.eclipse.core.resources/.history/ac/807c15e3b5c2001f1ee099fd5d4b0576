package org.techhub.client;

import java.time.LocalDateTime;
import java.util.*;

import org.techhub.model.ProductModel;
import org.techhub.model.UserModel;
import org.techhub.service.AuthService;
import org.techhub.service.AuthServiceImpl;
import org.techhub.service.ProductService;
import org.techhub.service.ProductServiceImpl;

public class EcommerceCartSystemApp {

	public static void main(String[] args) {
		Scanner sc = new Scanner(System.in);
		ProductService prodService = new ProductServiceImpl();
//		do {
//			Scanner sc = new Scanner(System.in);
//			System.out.println("1: Add new Product\n2: View all Products\n3: Search Product\n9: Exit");
//			System.out.println("Enter your choice: ");
//			int choice = sc.nextInt();
//			switch (choice) {
//			case 1:
//				System.out.println("Enter Product name: ");
//				sc.nextLine();
//				String prodName = sc.nextLine();
//				System.out.println("Enter Product Description");
//				String prodDesc = sc.nextLine();
//				System.out.println("Enter Product Price");
//				double prodPrice = sc.nextDouble();
//				System.out.println("Enter Stock Quantity");
//				int prodStockQuantity = sc.nextInt();
//				LocalDateTime prodCreatedAt = LocalDateTime.now();
//
//				String result = prodService.addNewProduct(
//						new ProductModel(0, prodName, prodDesc, prodPrice, prodStockQuantity, prodCreatedAt))
//								? "Product Added Successfully"
//								: "Product Not Added";
//
//				System.out.println(result);
//				break;
//			case 2:
//				Optional<List<ProductModel>> olist = prodService.getAllProducts();
//				if (olist.isPresent()) {
//					List<ProductModel> list = olist.get();
//					list.forEach(
//							(p) -> System.out.println(p.getProductId() + "\t" + p.getName() + "\t" + p.getDescription()
//									+ "\t" + p.getPrice() + "\t" + p.getStockQuantity() + "\t" + p.getCreatedAt()));
//				} else {
//					System.out.println("There is no Product data Available");
//				}
//				break;
//				
//			case 3:
//				System.out.println("Enter Product Name: ");
//				sc.nextLine();
//				prodName = sc.nextLine();
//				//System.out.println(prodName);
//				ProductModel p = prodService.getProductByName(prodName);
//				
//				if(p!=null) {
//					System.out.println(p.getProductId() + "\t" + p.getName() + "\t" + p.getDescription()
//					+ "\t" + p.getPrice() + "\t" + p.getStockQuantity() + "\t" + p.getCreatedAt());
//				}else {
//					System.out.println("Product Not Found!");
//				}
//				break;
//			case 9:
//				System.exit(0);
//				break;
//			default:
//				System.out.println("Invalid Choice!");
//			}
//		} while (true);
		
		AuthService authService = new AuthServiceImpl();
		boolean flag = true;
		
		do {
			System.out.println("1. Register as admin or normal user(user)\n2. Login as admin or user\n3. Exit");
			System.out.println("Enter your Choice: ");
			int ch = sc.nextInt();
			
			switch(ch) {
			case 1:
				sc.nextLine();
				System.out.println("Enter Username: ");
				String username = sc.nextLine();
				System.out.println("Enter Email: ");
				String email = sc.nextLine();
				System.out.println("Enter password: ");
                String password = sc.nextLine();
                System.out.println("Register as: 1. Admin 2. Normal User");
                int roleChoice = sc.nextInt();
                LocalDateTime userCreatedAt = LocalDateTime.now();
                String role = (roleChoice == 1) ? "admin" : "normal";
                
                UserModel newUser = new UserModel(username,email,password,userCreatedAt,role);
                
                if (authService.registerUser(newUser)) {
                    System.out.println("Registration successful!");
                } else {
                    System.out.println("Registration failed. Username or email may already exist.");
                }
                
				break;
			}
		}while(flag);
		
	}

}
